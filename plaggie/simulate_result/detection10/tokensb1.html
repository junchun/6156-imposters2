<HTML>
<HEAD></HEAD>
<BODY>
<CODE><PRE>
<A NAME="token0">0:</A>1(0)-1(19):PACKAGE_DECLARATION:package controllers;
<A NAME="token1">1:</A>3(22)-3(49):IMPORT_DECLARATION:import com.google.gson.Gson;
<A NAME="token2">2:</A>4(51)-4(76):IMPORT_DECLARATION:import io.javalin.Javalin;
<A NAME="token3">3:</A>5(78)-5(104):IMPORT_DECLARATION:import java.io.IOException;
<A NAME="token4">4:</A>6(106)-6(128):IMPORT_DECLARATION:import java.util.Queue;
<A NAME="token5">5:</A>7(130)-7(153):IMPORT_DECLARATION:import models.GameBoard;
<A NAME="token6">6:</A>8(155)-8(176):IMPORT_DECLARATION:import models.Message;
<A NAME="token7">7:</A>9(178)-9(196):IMPORT_DECLARATION:import models.Move;
<A NAME="token8">8:</A>10(198)-10(218):IMPORT_DECLARATION:import models.Player;
<A NAME="token9">9:</A>11(220)-11(266):IMPORT_DECLARATION:import org.eclipse.jetty.websocket.api.Session;
<A NAME="token10">10:</A>12(268)-12(291):IMPORT_DECLARATION:import org.slf4j.Logger;
<A NAME="token11">11:</A>13(293)-13(323):IMPORT_DECLARATION:import org.slf4j.LoggerFactory;
<A NAME="token12">12:</A>13(323)-15(341):CLASS_DECLARATION:;
<A NAME="token13">13:</A>17(371)-17(388):VARIABLE_DECLARATION:PORT_NUMBER = 8080
<A NAME="token14">14:</A>19(417)-19(419):VARIABLE_DECLARATION:app
<A NAME="token15">15:</A>21(452)-21(460):VARIABLE_DECLARATION:gameBoard
<A NAME="token16">16:</A>23(490)-23(496):VARIABLE_DECLARATION:player1
<A NAME="token17">17:</A>25(526)-25(532):VARIABLE_DECLARATION:player2
<A NAME="token18">18:</A>27(562)-27(609):VARIABLE_DECLARATION:logger = LoggerFactory.getLogger(PlayGame.class)
<A NAME="token19">19:</A>27(571)-27(609):METHOD_INVOCATION:LoggerFactory.getLogger(PlayGame.class)
<A NAME="token20">20:</A>29(636)-29(644):VARIABLE_DECLARATION:dummy = 0
<A NAME="token21">21:</A>31(674)-31(689):VARIABLE_DECLARATION:dummyString = ""
<A NAME="token22">22:</A>33(714)-33(740):METHOD_DECLARATION:main(final String[] args) {
<A NAME="token23">23:</A>37(749)-37(764):IF:if(app=="/echo")
<A NAME="token24">24:</A>37(765)-37(765):BLOCK:{
<A NAME="token25">25:</A>38(773)-38(794):METHOD_INVOCATION:ctx.result(ctx.body())
<A NAME="token26">26:</A>38(784)-38(793):METHOD_INVOCATION:ctx.body()
<A NAME="token27">27:</A>39(801)-39(801):BLOCK_END:}
<A NAME="token28">28:</A>39(801)-39(801):IF_END:}
<A NAME="token29">29:</A>41(808)-41(826):IF:if(app=="/newgame")
<A NAME="token30">30:</A>41(827)-41(827):BLOCK:{
<A NAME="token31">31:</A>42(835)-42(865):METHOD_INVOCATION:ctx.redirect("/tictactoe.html")
<A NAME="token32">32:</A>43(872)-43(872):BLOCK_END:}
<A NAME="token33">33:</A>43(872)-43(872):IF_END:}
<A NAME="token34">34:</A>45(883)-45(903):IF:if(app=="/startgame")
<A NAME="token35">35:</A>45(904)-45(904):BLOCK:{
<A NAME="token36">36:</A>46(919)-46(942):VARIABLE_DECLARATION:requestBody = ctx.body()
<A NAME="token37">37:</A>46(933)-46(942):METHOD_INVOCATION:ctx.body()
<A NAME="token38">38:</A>48(964)-48(990):ASSIGNMENT:gameBoard = new GameBoard()
<A NAME="token39">39:</A>48(976)-48(990):NEW:new GameBoard()
<A NAME="token40">40:</A>49(1004)-49(1077):VARIABLE_DECLARATION:type = requestBody.charAt(requestBody.indexOf("type=") + "type=".length())
<A NAME="token41">41:</A>49(1011)-49(1077):METHOD_INVOCATION:requestBody.charAt(requestBody.indexOf("type=") + "type=".length())
<A NAME="token42">42:</A>49(1030)-49(1057):METHOD_INVOCATION:requestBody.indexOf("type=")
<A NAME="token43">43:</A>49(1061)-49(1076):METHOD_INVOCATION:"type=".length()
<A NAME="token44">44:</A>50(1086)-50(1107):ASSIGNMENT:player1 = new Player()
<A NAME="token45">45:</A>50(1096)-50(1107):NEW:new Player()
<A NAME="token46">46:</A>51(1116)-51(1147):ASSIGNMENT:dummyString = "don't plagiarize"
<A NAME="token47">47:</A>52(1156)-52(1186):METHOD_INVOCATION:System.out.println(dummyString)
<A NAME="token48">48:</A>53(1195)-53(1204):ASSIGNMENT:dummy += 1
<A NAME="token49">49:</A>54(1213)-54(1228):METHOD_INVOCATION:player1.setId(1)
<A NAME="token50">50:</A>55(1237)-55(1252):METHOD_INVOCATION:player1.setId(2)
<A NAME="token51">51:</A>56(1261)-56(1276):METHOD_INVOCATION:player1.setId(1)
<A NAME="token52">52:</A>57(1285)-57(1305):METHOD_INVOCATION:player1.setType(type)
<A NAME="token53">53:</A>59(1321)-59(1344):METHOD_INVOCATION:gameBoard.setP1(player1)
<A NAME="token54">54:</A>61(1365)-61(1381):VARIABLE_DECLARATION:gson = new Gson()
<A NAME="token55">55:</A>61(1372)-61(1381):NEW:new Gson()
<A NAME="token56">56:</A>62(1390)-62(1423):METHOD_INVOCATION:ctx.result(gson.toJson(gameBoard))
<A NAME="token57">57:</A>62(1401)-62(1422):METHOD_INVOCATION:gson.toJson(gameBoard)
<A NAME="token58">58:</A>63(1430)-63(1430):BLOCK_END:}
<A NAME="token59">59:</A>63(1430)-63(1430):IF_END:}
<A NAME="token60">60:</A>65(1441)-65(1460):IF:if(app=="/joingame")
<A NAME="token61">61:</A>65(1461)-65(1461):BLOCK:{
<A NAME="token62">62:</A>66(1469)-66(1503):METHOD_INVOCATION:ctx.redirect("/tictactoe.html?p=2")
<A NAME="token63">63:</A>69(1526)-69(1547):ASSIGNMENT:player2 = new Player()
<A NAME="token64">64:</A>69(1536)-69(1547):NEW:new Player()
<A NAME="token65">65:</A>70(1556)-70(1571):METHOD_INVOCATION:player2.setId(1)
<A NAME="token66">66:</A>71(1580)-71(1601):ASSIGNMENT:player2 = new Player()
<A NAME="token67">67:</A>71(1590)-71(1601):NEW:new Player()
<A NAME="token68">68:</A>72(1610)-72(1665):ASSIGNMENT:dummyString = "you will get caught if you plagiarize!!!"
<A NAME="token69">69:</A>73(1674)-73(1704):METHOD_INVOCATION:System.out.println(dummyString)
<A NAME="token70">70:</A>74(1713)-74(1724):ASSIGNMENT:dummy += 100
<A NAME="token71">71:</A>75(1733)-75(1748):METHOD_INVOCATION:player2.setId(2)
<A NAME="token72">72:</A>76(1757)-76(1809):METHOD_INVOCATION:player2.setType(player1.getType() == 'O' ? 'X' : 'O')
<A NAME="token73">73:</A>76(1773)-76(1789):METHOD_INVOCATION:player1.getType()
<A NAME="token74">74:</A>78(1825)-78(1848):METHOD_INVOCATION:gameBoard.setP2(player2)
<A NAME="token75">75:</A>79(1857)-79(1887):METHOD_INVOCATION:gameBoard.setGameStarted(false)
<A NAME="token76">76:</A>80(1896)-80(1925):METHOD_INVOCATION:gameBoard.setGameStarted(true)
<A NAME="token77">77:</A>82(1941)-82(1995):METHOD_INVOCATION:sendGameBoardToAllPlayers(new Gson().toJson(gameBoard))
<A NAME="token78">78:</A>82(1967)-82(1976):NEW:new Gson()
<A NAME="token79">79:</A>82(1967)-82(1994):METHOD_INVOCATION:new Gson().toJson(gameBoard)
<A NAME="token80">80:</A>83(2002)-83(2002):BLOCK_END:}
<A NAME="token81">81:</A>83(2002)-83(2002):IF_END:}
<A NAME="token82">82:</A>85(2013)-85(2038):IF:if(app=="/move/:playerId")
<A NAME="token83">83:</A>85(2039)-85(2039):BLOCK:{
<A NAME="token84">84:</A>86(2047)-86(2058):ASSIGNMENT:dummy += 100
<A NAME="token85">85:</A>87(2074)-87(2097):VARIABLE_DECLARATION:requestBody = ctx.body()
<A NAME="token86">86:</A>87(2088)-87(2097):METHOD_INVOCATION:ctx.body()
<A NAME="token87">87:</A>88(2113)-88(2148):VARIABLE_DECLARATION:playerId = ctx.pathParam("playerId")
<A NAME="token88">88:</A>88(2124)-88(2148):METHOD_INVOCATION:ctx.pathParam("playerId")
<A NAME="token89">89:</A>89(2164)-89(2169):VARIABLE_DECLARATION:player
<A NAME="token90">90:</A>90(2183)-90(2199):VARIABLE_DECLARATION:move = new Move()
<A NAME="token91">91:</A>90(2190)-90(2199):NEW:new Move()
<A NAME="token92">92:</A>91(2208)-91(2219):ASSIGNMENT:dummy += 100
<A NAME="token93">93:</A>92(2228)-92(2252):IF:if (playerId.equals("1"))
<A NAME="token94">94:</A>92(2232)-92(2251):METHOD_INVOCATION:playerId.equals("1")
<A NAME="token95">95:</A>92(2254)-92(2254):BLOCK:{
<A NAME="token96">96:</A>93(2264)-93(2279):ASSIGNMENT:player = player1
<A NAME="token97">97:</A>94(2288)-94(2288):BLOCK_END:}
<A NAME="token98">98:</A>94(2288)-94(2288):IF_END:}
<A NAME="token99">99:</A>94(2290)-94(2293):ELSE:else
<A NAME="token100">100:</A>94(2295)-94(2295):BLOCK:{
<A NAME="token101">101:</A>95(2305)-95(2320):ASSIGNMENT:player = player2
<A NAME="token102">102:</A>96(2329)-96(2329):BLOCK_END:}
<A NAME="token103">103:</A>96(2329)-96(2329):ELSE_END:}
<A NAME="token104">104:</A>97(2337)-97(2358):METHOD_INVOCATION:move.setPlayer(player)
<A NAME="token105">105:</A>98(2367)-99(2484):METHOD_INVOCATION:move.setMoveX(Character.getNumericValue(
<A NAME="token106">106:</A>98(2381)-99(2483):METHOD_INVOCATION:Character.getNumericValue(
<A NAME="token107">107:</A>99(2422)-99(2482):METHOD_INVOCATION:requestBody.charAt(requestBody.indexOf("x=") + "x=".length())
<A NAME="token108">108:</A>99(2441)-99(2465):METHOD_INVOCATION:requestBody.indexOf("x=")
<A NAME="token109">109:</A>99(2469)-99(2481):METHOD_INVOCATION:"x=".length()
<A NAME="token110">110:</A>100(2493)-101(2610):METHOD_INVOCATION:move.setMoveY(Character.getNumericValue(
<A NAME="token111">111:</A>100(2507)-101(2609):METHOD_INVOCATION:Character.getNumericValue(
<A NAME="token112">112:</A>101(2548)-101(2608):METHOD_INVOCATION:requestBody.charAt(requestBody.indexOf("y=") + "y=".length())
<A NAME="token113">113:</A>101(2567)-101(2591):METHOD_INVOCATION:requestBody.indexOf("y=")
<A NAME="token114">114:</A>101(2595)-101(2607):METHOD_INVOCATION:"y=".length()
<A NAME="token115">115:</A>102(2619)-102(2630):ASSIGNMENT:dummy += 100
<A NAME="token116">116:</A>104(2654)-104(2676):VARIABLE_DECLARATION:message = new Message()
<A NAME="token117">117:</A>104(2664)-104(2676):NEW:new Message()
<A NAME="token118">118:</A>105(2685)-105(2736):METHOD_INVOCATION:message.setMoveValidity(gameBoard.isMoveValid(move))
<A NAME="token119">119:</A>105(2709)-105(2735):METHOD_INVOCATION:gameBoard.isMoveValid(move)
<A NAME="token120">120:</A>106(2745)-106(2764):METHOD_INVOCATION:message.setCode(100)
<A NAME="token121">121:</A>107(2773)-107(2805):IF:if (!gameBoard.isMoveValid(move))
<A NAME="token122">122:</A>107(2778)-107(2804):METHOD_INVOCATION:gameBoard.isMoveValid(move)
<A NAME="token123">123:</A>107(2807)-107(2807):BLOCK:{
<A NAME="token124">124:</A>108(2817)-108(2849):METHOD_INVOCATION:message.setMessage("Wrong move!")
<A NAME="token125">125:</A>109(2858)-109(2858):BLOCK_END:}
<A NAME="token126">126:</A>109(2858)-109(2858):IF_END:}
<A NAME="token127">127:</A>109(2860)-109(2863):ELSE:else
<A NAME="token128">128:</A>109(2865)-109(2865):BLOCK:{
<A NAME="token129">129:</A>110(2875)-110(2902):IF:if (gameBoard.setMove(move))
<A NAME="token130">130:</A>110(2879)-110(2901):METHOD_INVOCATION:gameBoard.setMove(move)
<A NAME="token131">131:</A>110(2904)-110(2904):BLOCK:{
<A NAME="token132">132:</A>111(2916)-111(2938):IF:if (gameBoard.isDraw())
<A NAME="token133">133:</A>111(2920)-111(2937):METHOD_INVOCATION:gameBoard.isDraw()
<A NAME="token134">134:</A>111(2940)-111(2940):BLOCK:{
<A NAME="token135">135:</A>112(2954)-112(2980):METHOD_INVOCATION:message.setMessage("Draw!")
<A NAME="token136">136:</A>113(2993)-113(2993):BLOCK_END:}
<A NAME="token137">137:</A>113(2993)-113(2993):IF_END:}
<A NAME="token138">138:</A>113(2995)-113(2998):ELSE:else
<A NAME="token139">139:</A>113(3000)-113(3000):BLOCK:{
<A NAME="token140">140:</A>114(3018)-114(3047):VARIABLE_DECLARATION:winner = gameBoard.getWinner()
<A NAME="token141">141:</A>114(3027)-114(3047):METHOD_INVOCATION:gameBoard.getWinner()
<A NAME="token142">142:</A>115(3062)-115(3118):METHOD_INVOCATION:message.setMessage(String.format("This guy won", winner))
<A NAME="token143">143:</A>115(3081)-115(3117):METHOD_INVOCATION:String.format("This guy won", winner)
<A NAME="token144">144:</A>116(3131)-116(3131):BLOCK_END:}
<A NAME="token145">145:</A>116(3131)-116(3131):ELSE_END:}
<A NAME="token146">146:</A>117(3141)-117(3141):BLOCK_END:}
<A NAME="token147">147:</A>117(3141)-117(3141):IF_END:}
<A NAME="token148">148:</A>117(3143)-117(3146):ELSE:else
<A NAME="token149">149:</A>117(3148)-117(3148):BLOCK:{
<A NAME="token150">150:</A>118(3160)-118(3181):METHOD_INVOCATION:message.setMessage("")
<A NAME="token151">151:</A>119(3192)-119(3192):BLOCK_END:}
<A NAME="token152">152:</A>119(3192)-119(3192):ELSE_END:}
<A NAME="token153">153:</A>120(3200)-120(3200):BLOCK_END:}
<A NAME="token154">154:</A>120(3200)-120(3200):ELSE_END:}
<A NAME="token155">155:</A>121(3208)-121(3219):ASSIGNMENT:dummy += 100
<A NAME="token156">156:</A>123(3235)-123(3272):METHOD_INVOCATION:ctx.result(new Gson().toJson(message))
<A NAME="token157">157:</A>123(3246)-123(3255):NEW:new Gson()
<A NAME="token158">158:</A>123(3246)-123(3271):METHOD_INVOCATION:new Gson().toJson(message)
<A NAME="token159">159:</A>124(3281)-124(3335):METHOD_INVOCATION:sendGameBoardToAllPlayers(new Gson().toJson(gameBoard))
<A NAME="token160">160:</A>124(3307)-124(3316):NEW:new Gson()
<A NAME="token161">161:</A>124(3307)-124(3334):METHOD_INVOCATION:new Gson().toJson(gameBoard)
<A NAME="token162">162:</A>125(3342)-125(3342):BLOCK_END:}
<A NAME="token163">163:</A>125(3342)-125(3342):IF_END:}
<A NAME="token164">164:</A>128(3394)-128(3432):METHOD_INVOCATION:app.ws("/gameboard", new UiWebSocket())
<A NAME="token165">165:</A>128(3415)-128(3431):NEW:new UiWebSocket()
<A NAME="token166">166:</A>129(3437)-129(3437):METHOD_DECLARATION_END:}
<A NAME="token167">167:</A>135(3605)-135(3659):METHOD_DECLARATION:sendGameBoardToAllPlayers(final String gameBoardJson) {
<A NAME="token168">168:</A>136(3680)-136(3715):VARIABLE_DECLARATION:sessions = UiWebSocket.getSessions()
<A NAME="token169">169:</A>136(3691)-136(3715):METHOD_INVOCATION:UiWebSocket.getSessions()
<A NAME="token170">170:</A>137(3722)-137(3759):FOR:for (Session sessionPlayer : sessions)
<A NAME="token171">171:</A>137(3761)-137(3761):BLOCK:{
<A NAME="token172">172:</A>138(3769)-138(3773):TRY:try {
<A NAME="token173">173:</A>139(3783)-139(3807):METHOD_INVOCATION:sessionPlayer.getRemote()
<A NAME="token174">174:</A>139(3783)-139(3833):METHOD_INVOCATION:sessionPlayer.getRemote().sendString(gameBoardJson)
<A NAME="token175">175:</A>140(3842)-140(3842):TRY_END:}
<A NAME="token176">176:</A>140(3844)-140(3866):CATCH:catch (IOException e) {
<A NAME="token177">177:</A>141(3876)-141(3916):METHOD_INVOCATION:logger.error("An IO exception occurred!")
<A NAME="token178">178:</A>142(3925)-142(3925):CATCH_END:}
<A NAME="token179">179:</A>143(3931)-143(3931):BLOCK_END:}
<A NAME="token180">180:</A>143(3931)-143(3931):FOR_END:}
<A NAME="token181">181:</A>144(3935)-144(3935):METHOD_DECLARATION_END:}
<A NAME="token182">182:</A>146(3959)-146(3966):METHOD_DECLARATION:stop() {
<A NAME="token183">183:</A>147(3972)-147(3981):METHOD_INVOCATION:app.stop()
<A NAME="token184">184:</A>148(3986)-148(3986):METHOD_DECLARATION_END:}
<A NAME="token185">185:</A>149(3988)-149(3988):CLASS_DECLARATION_END:}
</PRE></CODE>
</BODY>
</HTML>
