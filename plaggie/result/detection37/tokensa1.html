<HTML>
<HEAD></HEAD>
<BODY>
<CODE><PRE>
<A NAME="token0">0:</A>1(0)-1(19):PACKAGE_DECLARATION:package controllers;
<A NAME="token1">1:</A>3(22)-3(47):IMPORT_DECLARATION:import io.javalin.Javalin;
<A NAME="token2">2:</A>4(49)-4(75):IMPORT_DECLARATION:import java.io.IOException;
<A NAME="token3">3:</A>5(77)-5(99):IMPORT_DECLARATION:import java.util.Queue;
<A NAME="token4">4:</A>6(101)-6(124):IMPORT_DECLARATION:import models.GameBoard;
<A NAME="token5">5:</A>7(126)-7(147):IMPORT_DECLARATION:import models.Message;
<A NAME="token6">6:</A>8(149)-8(167):IMPORT_DECLARATION:import models.Move;
<A NAME="token7">7:</A>9(169)-9(215):IMPORT_DECLARATION:import org.eclipse.jetty.websocket.api.Session;
<A NAME="token8">8:</A>9(215)-11(233):CLASS_DECLARATION:;
<A NAME="token9">9:</A>13(263)-13(280):VARIABLE_DECLARATION:PORT_NUMBER = 8080
<A NAME="token10">10:</A>14(310)-14(318):VARIABLE_DECLARATION:gameBoard
<A NAME="token11">11:</A>15(346)-15(352):VARIABLE_DECLARATION:message
<A NAME="token12">12:</A>16(377)-16(380):VARIABLE_DECLARATION:move
<A NAME="token13">13:</A>18(409)-18(411):VARIABLE_DECLARATION:app
<A NAME="token14">14:</A>23(520)-23(546):METHOD_DECLARATION:main(final String[] args) {
<A NAME="token15">15:</A>24(552)-24(568):ASSIGNMENT:move = new Move()
<A NAME="token16">16:</A>24(559)-24(568):NEW:new Move()
<A NAME="token17">17:</A>25(575)-25(597):ASSIGNMENT:message = new Message()
<A NAME="token18">18:</A>25(585)-25(597):NEW:new Message()
<A NAME="token19">19:</A>30(631)-30(646):IF:if(app=="/echo")
<A NAME="token20">20:</A>30(648)-30(648):BLOCK:{
<A NAME="token21">21:</A>31(656)-31(677):METHOD_INVOCATION:ctx.result(ctx.body())
<A NAME="token22">22:</A>31(667)-31(676):METHOD_INVOCATION:ctx.body()
<A NAME="token23">23:</A>32(684)-32(684):BLOCK_END:}
<A NAME="token24">24:</A>32(684)-32(684):IF_END:}
<A NAME="token25">25:</A>37(753)-37(771):IF:if(app=="/newgame")
<A NAME="token26">26:</A>37(773)-37(773):BLOCK:{
<A NAME="token27">27:</A>38(781)-38(810):METHOD_INVOCATION:ctx.redirect("tictactoe.html")
<A NAME="token28">28:</A>39(817)-39(817):BLOCK_END:}
<A NAME="token29">29:</A>39(817)-39(817):IF_END:}
<A NAME="token30">30:</A>42(860)-42(880):IF:if(app=="/startgame")
<A NAME="token31">31:</A>42(882)-42(882):BLOCK:{
<A NAME="token32">32:</A>45(927)-45(960):VARIABLE_DECLARATION:clientType = ctx.formParam("type")
<A NAME="token33">33:</A>45(940)-45(960):METHOD_INVOCATION:ctx.formParam("type")
<A NAME="token34">34:</A>46(974)-46(1002):VARIABLE_DECLARATION:p1Type = clientType.charAt(0)
<A NAME="token35">35:</A>46(983)-46(1002):METHOD_INVOCATION:clientType.charAt(0)
<A NAME="token36">36:</A>49(1033)-49(1059):ASSIGNMENT:gameBoard = new GameBoard()
<A NAME="token37">37:</A>49(1045)-49(1059):NEW:new GameBoard()
<A NAME="token38">38:</A>50(1068)-50(1098):METHOD_INVOCATION:gameBoard.setPlayer1(1, p1Type)
<A NAME="token39">39:</A>53(1133)-53(1147):METHOD_INVOCATION:ctx.status(200)
<A NAME="token40">40:</A>54(1156)-54(1188):METHOD_INVOCATION:ctx.result(gameBoard.boardJson())
<A NAME="token41">41:</A>54(1167)-54(1187):METHOD_INVOCATION:gameBoard.boardJson()
<A NAME="token42">42:</A>56(1199)-56(1199):BLOCK_END:}
<A NAME="token43">43:</A>56(1199)-56(1199):IF_END:}
<A NAME="token44">44:</A>59(1241)-59(1260):IF:if(app=="/joingame")
<A NAME="token45">45:</A>59(1262)-59(1262):BLOCK:{
<A NAME="token46">46:</A>61(1296)-61(1355):VARIABLE_DECLARATION:p2Type = gameBoard.getPlayer1().getType() == 'X' ? 'O' : 'X'
<A NAME="token47">47:</A>61(1305)-61(1326):METHOD_INVOCATION:gameBoard.getPlayer1()
<A NAME="token48">48:</A>61(1305)-61(1336):METHOD_INVOCATION:gameBoard.getPlayer1().getType()
<A NAME="token49">49:</A>62(1364)-62(1394):METHOD_INVOCATION:gameBoard.setPlayer2(2, p2Type)
<A NAME="token50">50:</A>65(1430)-65(1452):METHOD_INVOCATION:gameBoard.setGame(true)
<A NAME="token51">51:</A>68(1491)-68(1538):METHOD_INVOCATION:sendGameBoardToAllPlayers(gameBoard.boardJson())
<A NAME="token52">52:</A>68(1517)-68(1537):METHOD_INVOCATION:gameBoard.boardJson()
<A NAME="token53">53:</A>71(1575)-71(1609):METHOD_INVOCATION:ctx.redirect("/tictactoe.html?p=2")
<A NAME="token54">54:</A>72(1616)-72(1616):BLOCK_END:}
<A NAME="token55">55:</A>72(1616)-72(1616):IF_END:}
<A NAME="token56">56:</A>74(1627)-74(1652):IF:if(app=="/move/:playerId")
<A NAME="token57">57:</A>74(1654)-74(1654):BLOCK:{
<A NAME="token58">58:</A>76(1685)-76(1738):VARIABLE_DECLARATION:playerId = Integer.parseInt(ctx.pathParam("playerId"))
<A NAME="token59">59:</A>76(1696)-76(1738):METHOD_INVOCATION:Integer.parseInt(ctx.pathParam("playerId"))
<A NAME="token60">60:</A>76(1713)-76(1737):METHOD_INVOCATION:ctx.pathParam("playerId")
<A NAME="token61">61:</A>77(1751)-77(1794):VARIABLE_DECLARATION:moveX = Integer.parseInt(ctx.formParam("x"))
<A NAME="token62">62:</A>77(1759)-77(1794):METHOD_INVOCATION:Integer.parseInt(ctx.formParam("x"))
<A NAME="token63">63:</A>77(1776)-77(1793):METHOD_INVOCATION:ctx.formParam("x")
<A NAME="token64">64:</A>78(1807)-78(1850):VARIABLE_DECLARATION:moveY = Integer.parseInt(ctx.formParam("y"))
<A NAME="token65">65:</A>78(1815)-78(1850):METHOD_INVOCATION:Integer.parseInt(ctx.formParam("y"))
<A NAME="token66">66:</A>78(1832)-78(1849):METHOD_INVOCATION:ctx.formParam("y")
<A NAME="token67">67:</A>81(1893)-81(1939):METHOD_INVOCATION:move.setMove(gameBoard, playerId, moveX, moveY)
<A NAME="token68">68:</A>84(1977)-84(2012):METHOD_INVOCATION:gameBoard.playerMoves(move, message)
<A NAME="token69">69:</A>87(2045)-87(2077):METHOD_INVOCATION:ctx.result(message.messageJson())
<A NAME="token70">70:</A>87(2056)-87(2076):METHOD_INVOCATION:message.messageJson()
<A NAME="token71">71:</A>88(2086)-88(2133):METHOD_INVOCATION:sendGameBoardToAllPlayers(gameBoard.boardJson())
<A NAME="token72">72:</A>88(2112)-88(2132):METHOD_INVOCATION:gameBoard.boardJson()
<A NAME="token73">73:</A>89(2143)-89(2143):BLOCK_END:}
<A NAME="token74">74:</A>89(2143)-89(2143):IF_END:}
<A NAME="token75">75:</A>92(2195)-92(2233):METHOD_INVOCATION:app.ws("/gameboard", new UiWebSocket())
<A NAME="token76">76:</A>92(2216)-92(2232):NEW:new UiWebSocket()
<A NAME="token77">77:</A>93(2238)-93(2238):METHOD_DECLARATION_END:}
<A NAME="token78">78:</A>99(2406)-99(2460):METHOD_DECLARATION:sendGameBoardToAllPlayers(final String gameBoardJson) {
<A NAME="token79">79:</A>100(2481)-100(2516):VARIABLE_DECLARATION:sessions = UiWebSocket.getSessions()
<A NAME="token80">80:</A>100(2492)-100(2516):METHOD_INVOCATION:UiWebSocket.getSessions()
<A NAME="token81">81:</A>101(2523)-101(2560):FOR:for (Session sessionPlayer : sessions)
<A NAME="token82">82:</A>101(2562)-101(2562):BLOCK:{
<A NAME="token83">83:</A>102(2570)-102(2574):TRY:try {
<A NAME="token84">84:</A>103(2584)-103(2608):METHOD_INVOCATION:sessionPlayer.getRemote()
<A NAME="token85">85:</A>103(2584)-103(2634):METHOD_INVOCATION:sessionPlayer.getRemote().sendString(gameBoardJson)
<A NAME="token86">86:</A>104(2643)-104(2643):TRY_END:}
<A NAME="token87">87:</A>104(2645)-104(2667):CATCH:catch (IOException e) {
<A NAME="token88">88:</A>106(2704)-106(2735):METHOD_INVOCATION:System.out.println("send error")
<A NAME="token89">89:</A>107(2744)-107(2744):CATCH_END:}
<A NAME="token90">90:</A>108(2750)-108(2750):BLOCK_END:}
<A NAME="token91">91:</A>108(2750)-108(2750):FOR_END:}
<A NAME="token92">92:</A>109(2754)-109(2754):METHOD_DECLARATION_END:}
<A NAME="token93">93:</A>111(2778)-111(2785):METHOD_DECLARATION:stop() {
<A NAME="token94">94:</A>112(2791)-112(2800):METHOD_INVOCATION:app.stop()
<A NAME="token95">95:</A>113(2805)-113(2805):METHOD_DECLARATION_END:}
<A NAME="token96">96:</A>114(2807)-114(2807):CLASS_DECLARATION_END:}
</PRE></CODE>
</BODY>
</HTML>
