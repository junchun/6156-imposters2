<HTML>
<HEAD></HEAD>
<BODY>
<CODE><PRE>
<A NAME="token0">0:</A>1(0)-1(19):PACKAGE_DECLARATION:package controllers;
<A NAME="token1">1:</A>3(22)-3(49):IMPORT_DECLARATION:import com.google.gson.Gson;
<A NAME="token2">2:</A>4(51)-4(76):IMPORT_DECLARATION:import io.javalin.Javalin;
<A NAME="token3">3:</A>5(78)-5(104):IMPORT_DECLARATION:import java.io.IOException;
<A NAME="token4">4:</A>6(106)-6(130):IMPORT_DECLARATION:import java.lang.Integer;
<A NAME="token5">5:</A>7(132)-7(154):IMPORT_DECLARATION:import java.util.Queue;
<A NAME="token6">6:</A>8(156)-8(179):IMPORT_DECLARATION:import models.GameBoard;
<A NAME="token7">7:</A>9(181)-9(202):IMPORT_DECLARATION:import models.Message;
<A NAME="token8">8:</A>10(204)-10(222):IMPORT_DECLARATION:import models.Move;
<A NAME="token9">9:</A>11(224)-11(244):IMPORT_DECLARATION:import models.Player;
<A NAME="token10">10:</A>12(246)-12(292):IMPORT_DECLARATION:import org.eclipse.jetty.websocket.api.Session;
<A NAME="token11">11:</A>12(292)-15(311):CLASS_DECLARATION:;
<A NAME="token12">12:</A>17(341)-17(358):VARIABLE_DECLARATION:PORT_NUMBER = 8080
<A NAME="token13">13:</A>19(387)-19(389):VARIABLE_DECLARATION:app
<A NAME="token14">14:</A>21(422)-21(426):VARIABLE_DECLARATION:board
<A NAME="token15">15:</A>23(460)-23(476):VARIABLE_DECLARATION:gson = new Gson()
<A NAME="token16">16:</A>23(467)-23(476):NEW:new Gson()
<A NAME="token17">17:</A>28(585)-28(611):METHOD_DECLARATION:main(final String[] args) {
<A NAME="token18">18:</A>33(644)-33(660):IF:if (app=="/echo")
<A NAME="token19">19:</A>33(662)-33(662):BLOCK:{
<A NAME="token20">20:</A>34(670)-34(691):METHOD_INVOCATION:ctx.result(ctx.body())
<A NAME="token21">21:</A>34(681)-34(690):METHOD_INVOCATION:ctx.body()
<A NAME="token22">22:</A>35(698)-35(698):BLOCK_END:}
<A NAME="token23">23:</A>35(698)-35(698):IF_END:}
<A NAME="token24">24:</A>38(730)-38(749):IF:if (app=="/newgame")
<A NAME="token25">25:</A>38(751)-38(751):BLOCK:{
<A NAME="token26">26:</A>39(759)-39(789):METHOD_INVOCATION:ctx.redirect("/tictactoe.html")
<A NAME="token27">27:</A>40(796)-40(796):BLOCK_END:}
<A NAME="token28">28:</A>40(796)-40(796):IF_END:}
<A NAME="token29">29:</A>43(834)-43(855):IF:if (app=="/startgame")
<A NAME="token30">30:</A>43(857)-43(857):BLOCK:{
<A NAME="token31">31:</A>45(922)-45(972):VARIABLE_DECLARATION:p1 = new Player(ctx.formParam("type").charAt(0), 1)
<A NAME="token32">32:</A>45(927)-45(972):NEW:new Player(ctx.formParam("type").charAt(0), 1)
<A NAME="token33">33:</A>45(938)-45(958):METHOD_INVOCATION:ctx.formParam("type")
<A NAME="token34">34:</A>45(938)-45(968):METHOD_INVOCATION:ctx.formParam("type").charAt(0)
<A NAME="token35">35:</A>46(981)-46(1005):METHOD_INVOCATION:ctx.result(startGame(p1))
<A NAME="token36">36:</A>46(992)-46(1004):METHOD_INVOCATION:startGame(p1)
<A NAME="token37">37:</A>47(1012)-47(1012):BLOCK_END:}
<A NAME="token38">38:</A>47(1012)-47(1012):IF_END:}
<A NAME="token39">39:</A>50(1049)-50(1069):IF:if (app=="/joingame")
<A NAME="token40">40:</A>50(1071)-50(1071):BLOCK:{
<A NAME="token41">41:</A>51(1079)-51(1088):METHOD_INVOCATION:joinGame()
<A NAME="token42">42:</A>52(1097)-52(1131):METHOD_INVOCATION:ctx.redirect("/tictactoe.html?p=2")
<A NAME="token43">43:</A>53(1138)-53(1138):BLOCK_END:}
<A NAME="token44">44:</A>53(1138)-53(1138):IF_END:}
<A NAME="token45">45:</A>56(1170)-56(1196):IF:if (app=="/move/:playerId")
<A NAME="token46">46:</A>56(1198)-56(1198):BLOCK:{
<A NAME="token47">47:</A>58(1271)-58(1324):VARIABLE_DECLARATION:playerId = Integer.parseInt(ctx.pathParam("playerId"))
<A NAME="token48">48:</A>58(1282)-58(1324):METHOD_INVOCATION:Integer.parseInt(ctx.pathParam("playerId"))
<A NAME="token49">49:</A>58(1299)-58(1323):METHOD_INVOCATION:ctx.pathParam("playerId")
<A NAME="token50">50:</A>59(1337)-59(1380):VARIABLE_DECLARATION:moveX = Integer.parseInt(ctx.formParam("x"))
<A NAME="token51">51:</A>59(1345)-59(1380):METHOD_INVOCATION:Integer.parseInt(ctx.formParam("x"))
<A NAME="token52">52:</A>59(1362)-59(1379):METHOD_INVOCATION:ctx.formParam("x")
<A NAME="token53">53:</A>60(1393)-60(1436):VARIABLE_DECLARATION:moveY = Integer.parseInt(ctx.formParam("y"))
<A NAME="token54">54:</A>60(1401)-60(1436):METHOD_INVOCATION:Integer.parseInt(ctx.formParam("y"))
<A NAME="token55">55:</A>60(1418)-60(1435):METHOD_INVOCATION:ctx.formParam("y")
<A NAME="token56">56:</A>62(1452)-62(1491):METHOD_INVOCATION:ctx.result(move(playerId, moveX, moveY))
<A NAME="token57">57:</A>62(1463)-62(1490):METHOD_INVOCATION:move(playerId, moveX, moveY)
<A NAME="token58">58:</A>63(1498)-63(1498):BLOCK_END:}
<A NAME="token59">59:</A>63(1498)-63(1498):IF_END:}
<A NAME="token60">60:</A>67(1555)-67(1593):METHOD_INVOCATION:app.ws("/gameboard", new UiWebSocket())
<A NAME="token61">61:</A>67(1576)-67(1592):NEW:new UiWebSocket()
<A NAME="token62">62:</A>68(1598)-68(1598):METHOD_DECLARATION_END:}
<A NAME="token63">63:</A>76(1747)-76(1768):METHOD_DECLARATION:startGame(Player p1) {
<A NAME="token64">64:</A>77(1774)-77(1798):ASSIGNMENT:board = new GameBoard(p1)
<A NAME="token65">65:</A>77(1782)-77(1798):NEW:new GameBoard(p1)
<A NAME="token66">66:</A>78(1805)-78(1830):RETURN:return gson.toJson(board);
<A NAME="token67">67:</A>78(1812)-78(1829):METHOD_INVOCATION:gson.toJson(board)
<A NAME="token68">68:</A>79(1834)-79(1834):METHOD_DECLARATION_END:}
<A NAME="token69">69:</A>84(1927)-84(1938):METHOD_DECLARATION:joinGame() {
<A NAME="token70">70:</A>85(1949)-85(1985):VARIABLE_DECLARATION:p1Type = board.getPlayer(1).getType()
<A NAME="token71">71:</A>85(1958)-85(1975):METHOD_INVOCATION:board.getPlayer(1)
<A NAME="token72">72:</A>85(1958)-85(1985):METHOD_INVOCATION:board.getPlayer(1).getType()
<A NAME="token73">73:</A>86(1997)-86(2002):VARIABLE_DECLARATION:p2Type
<A NAME="token74">74:</A>89(2049)-89(2066):IF:if (p1Type == 'X')
<A NAME="token75">75:</A>89(2068)-89(2068):BLOCK:{
<A NAME="token76">76:</A>90(2076)-90(2087):ASSIGNMENT:p2Type = 'O'
<A NAME="token77">77:</A>91(2094)-91(2094):BLOCK_END:}
<A NAME="token78">78:</A>91(2094)-91(2094):IF_END:}
<A NAME="token79">79:</A>91(2096)-91(2099):ELSE:else
<A NAME="token80">80:</A>91(2101)-91(2101):BLOCK:{
<A NAME="token81">81:</A>92(2109)-92(2120):ASSIGNMENT:p2Type = 'X'
<A NAME="token82">82:</A>93(2127)-93(2127):BLOCK_END:}
<A NAME="token83">83:</A>93(2127)-93(2127):ELSE_END:}
<A NAME="token84">84:</A>95(2145)-95(2170):VARIABLE_DECLARATION:p2 = new Player(p2Type, 2)
<A NAME="token85">85:</A>95(2150)-95(2170):NEW:new Player(p2Type, 2)
<A NAME="token86">86:</A>96(2177)-96(2196):METHOD_INVOCATION:board.addPlayer2(p2)
<A NAME="token87">87:</A>98(2208)-98(2252):METHOD_INVOCATION:sendGameBoardToAllPlayers(gson.toJson(board))
<A NAME="token88">88:</A>98(2234)-98(2251):METHOD_INVOCATION:gson.toJson(board)
<A NAME="token89">89:</A>99(2257)-99(2257):METHOD_DECLARATION_END:}
<A NAME="token90">90:</A>109(2550)-109(2591):METHOD_DECLARATION:move(int playerId, int moveX, int moveY) {
<A NAME="token91">91:</A>110(2604)-110(2644):VARIABLE_DECLARATION:currentPlayer = board.getPlayer(playerId)
<A NAME="token92">92:</A>110(2620)-110(2644):METHOD_INVOCATION:board.getPlayer(playerId)
<A NAME="token93">93:</A>111(2656)-111(2706):VARIABLE_DECLARATION:moveAttempt = new Move(currentPlayer, moveX, moveY)
<A NAME="token94">94:</A>111(2670)-111(2706):NEW:new Move(currentPlayer, moveX, moveY)
<A NAME="token95">95:</A>112(2721)-112(2758):VARIABLE_DECLARATION:response = board.playTurn(moveAttempt)
<A NAME="token96">96:</A>112(2732)-112(2758):METHOD_INVOCATION:board.playTurn(moveAttempt)
<A NAME="token97">97:</A>114(2770)-114(2814):METHOD_INVOCATION:sendGameBoardToAllPlayers(gson.toJson(board))
<A NAME="token98">98:</A>114(2796)-114(2813):METHOD_INVOCATION:gson.toJson(board)
<A NAME="token99">99:</A>115(2821)-115(2849):RETURN:return gson.toJson(response);
<A NAME="token100">100:</A>115(2828)-115(2848):METHOD_INVOCATION:gson.toJson(response)
<A NAME="token101">101:</A>116(2854)-116(2854):METHOD_DECLARATION_END:}
<A NAME="token102">102:</A>122(3024)-122(3078):METHOD_DECLARATION:sendGameBoardToAllPlayers(final String gameBoardJson) {
<A NAME="token103">103:</A>123(3099)-123(3134):VARIABLE_DECLARATION:sessions = UiWebSocket.getSessions()
<A NAME="token104">104:</A>123(3110)-123(3134):METHOD_INVOCATION:UiWebSocket.getSessions()
<A NAME="token105">105:</A>124(3141)-124(3178):FOR:for (Session sessionPlayer : sessions)
<A NAME="token106">106:</A>124(3180)-124(3180):BLOCK:{
<A NAME="token107">107:</A>125(3188)-125(3192):TRY:try {
<A NAME="token108">108:</A>126(3202)-126(3226):METHOD_INVOCATION:sessionPlayer.getRemote()
<A NAME="token109">109:</A>126(3202)-126(3252):METHOD_INVOCATION:sessionPlayer.getRemote().sendString(gameBoardJson)
<A NAME="token110">110:</A>127(3261)-127(3261):TRY_END:}
<A NAME="token111">111:</A>127(3263)-127(3285):CATCH:catch (IOException e) {
<A NAME="token112">112:</A>129(3320)-129(3320):CATCH_END:}
<A NAME="token113">113:</A>130(3326)-130(3326):BLOCK_END:}
<A NAME="token114">114:</A>130(3326)-130(3326):FOR_END:}
<A NAME="token115">115:</A>131(3330)-131(3330):METHOD_DECLARATION_END:}
<A NAME="token116">116:</A>133(3354)-133(3361):METHOD_DECLARATION:stop() {
<A NAME="token117">117:</A>134(3367)-134(3376):METHOD_INVOCATION:app.stop()
<A NAME="token118">118:</A>135(3381)-135(3381):METHOD_DECLARATION_END:}
<A NAME="token119">119:</A>136(3383)-136(3383):CLASS_DECLARATION_END:}
</PRE></CODE>
</BODY>
</HTML>
