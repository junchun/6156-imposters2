<HTML>
<HEAD></HEAD>
<BODY>
<CODE><PRE>
<A NAME="token0">0:</A>1(0)-1(19):PACKAGE_DECLARATION:package controllers;
<A NAME="token1">1:</A>3(22)-3(49):IMPORT_DECLARATION:import com.google.gson.Gson;
<A NAME="token2">2:</A>4(51)-4(85):IMPORT_DECLARATION:import com.google.gson.GsonBuilder;
<A NAME="token3">3:</A>5(87)-5(112):IMPORT_DECLARATION:import io.javalin.Javalin;
<A NAME="token4">4:</A>6(114)-6(140):IMPORT_DECLARATION:import java.io.IOException;
<A NAME="token5">5:</A>7(142)-7(164):IMPORT_DECLARATION:import java.util.Queue;
<A NAME="token6">6:</A>8(166)-8(189):IMPORT_DECLARATION:import models.GameBoard;
<A NAME="token7">7:</A>9(191)-9(212):IMPORT_DECLARATION:import models.Message;
<A NAME="token8">8:</A>10(214)-10(232):IMPORT_DECLARATION:import models.Move;
<A NAME="token9">9:</A>11(234)-11(254):IMPORT_DECLARATION:import models.Player;
<A NAME="token10">10:</A>12(256)-12(302):IMPORT_DECLARATION:import org.eclipse.jetty.websocket.api.Session;
<A NAME="token11">11:</A>12(302)-15(321):CLASS_DECLARATION:;
<A NAME="token12">12:</A>17(351)-17(368):VARIABLE_DECLARATION:PORT_NUMBER = 8080
<A NAME="token13">13:</A>19(397)-19(399):VARIABLE_DECLARATION:app
<A NAME="token14">14:</A>26(519)-26(545):METHOD_DECLARATION:main(final String[] args) {
<A NAME="token15">15:</A>31(579)-31(595):IF:if (app=="/echo")
<A NAME="token16">16:</A>31(597)-31(597):BLOCK:{
<A NAME="token17">17:</A>32(605)-32(626):METHOD_INVOCATION:ctx.result(ctx.body())
<A NAME="token18">18:</A>32(616)-32(625):METHOD_INVOCATION:ctx.body()
<A NAME="token19">19:</A>33(633)-33(633):BLOCK_END:}
<A NAME="token20">20:</A>33(633)-33(633):IF_END:}
<A NAME="token21">21:</A>36(691)-36(703):IF:if (app=="/")
<A NAME="token22">22:</A>36(705)-36(705):BLOCK:{
<A NAME="token23">23:</A>37(713)-37(743):METHOD_INVOCATION:ctx.redirect("/tictactoe.html")
<A NAME="token24">24:</A>38(750)-38(750):BLOCK_END:}
<A NAME="token25">25:</A>38(750)-38(750):IF_END:}
<A NAME="token26">26:</A>40(757)-40(776):IF:if (app=="/newgame")
<A NAME="token27">27:</A>40(778)-40(778):BLOCK:{
<A NAME="token28">28:</A>41(786)-41(816):METHOD_INVOCATION:ctx.redirect("/tictactoe.html")
<A NAME="token29">29:</A>42(823)-42(823):BLOCK_END:}
<A NAME="token30">30:</A>42(823)-42(823):IF_END:}
<A NAME="token31">31:</A>45(890)-45(916):VARIABLE_DECLARATION:gameBoard = new GameBoard()
<A NAME="token32">32:</A>45(902)-45(916):NEW:new GameBoard()
<A NAME="token33">33:</A>46(935)-46(961):VARIABLE_DECLARATION:builder = new GsonBuilder()
<A NAME="token34">34:</A>46(945)-46(961):NEW:new GsonBuilder()
<A NAME="token35">35:</A>47(973)-47(995):VARIABLE_DECLARATION:gson = builder.create()
<A NAME="token36">36:</A>47(980)-47(995):METHOD_INVOCATION:builder.create()
<A NAME="token37">37:</A>50(1046)-50(1066):IF:if (app=="/joingame")
<A NAME="token38">38:</A>50(1068)-50(1068):BLOCK:{
<A NAME="token39">39:</A>51(1076)-51(1108):IF:if (gameBoard.getP1Type() == 'O')
<A NAME="token40">40:</A>51(1080)-51(1100):METHOD_INVOCATION:gameBoard.getP1Type()
<A NAME="token41">41:</A>51(1110)-51(1110):BLOCK:{
<A NAME="token42">42:</A>52(1120)-52(1151):METHOD_INVOCATION:gameBoard.initializePlayer2('X')
<A NAME="token43">43:</A>53(1160)-53(1160):BLOCK_END:}
<A NAME="token44">44:</A>53(1160)-53(1160):IF_END:}
<A NAME="token45">45:</A>53(1162)-53(1165):ELSE:else
<A NAME="token46">46:</A>53(1167)-53(1167):BLOCK:{
<A NAME="token47">47:</A>54(1177)-54(1208):METHOD_INVOCATION:gameBoard.initializePlayer2('O')
<A NAME="token48">48:</A>55(1217)-55(1217):BLOCK_END:}
<A NAME="token49">49:</A>55(1217)-55(1217):ELSE_END:}
<A NAME="token50">50:</A>56(1225)-56(1245):METHOD_INVOCATION:gameBoard.startGame()
<A NAME="token51">51:</A>57(1261)-57(1298):VARIABLE_DECLARATION:gameBoardJson = gson.toJson(gameBoard)
<A NAME="token52">52:</A>57(1277)-57(1298):METHOD_INVOCATION:gson.toJson(gameBoard)
<A NAME="token53">53:</A>58(1307)-58(1346):METHOD_INVOCATION:sendGameBoardToAllPlayers(gameBoardJson)
<A NAME="token54">54:</A>59(1355)-59(1389):METHOD_INVOCATION:ctx.redirect("/tictactoe.html?p=2")
<A NAME="token55">55:</A>60(1396)-60(1396):BLOCK_END:}
<A NAME="token56">56:</A>60(1396)-60(1396):IF_END:}
<A NAME="token57">57:</A>63(1448)-63(1469):IF:if (app=="/startgame")
<A NAME="token58">58:</A>63(1471)-63(1471):BLOCK:{
<A NAME="token59">59:</A>64(1486)-64(1510):VARIABLE_DECLARATION:initialParam = ctx.body()
<A NAME="token60">60:</A>64(1501)-64(1510):METHOD_INVOCATION:ctx.body()
<A NAME="token61">61:</A>65(1524)-65(1578):VARIABLE_DECLARATION:p1Type = initialParam.charAt(initialParam.length() - 1)
<A NAME="token62">62:</A>65(1533)-65(1578):METHOD_INVOCATION:initialParam.charAt(initialParam.length() - 1)
<A NAME="token63">63:</A>65(1553)-65(1573):METHOD_INVOCATION:initialParam.length()
<A NAME="token64">64:</A>66(1587)-66(1617):METHOD_INVOCATION:gameBoard.initializeGameBoard()
<A NAME="token65">65:</A>67(1626)-67(1660):METHOD_INVOCATION:gameBoard.initializePlayer1(p1Type)
<A NAME="token66">66:</A>70(1718)-70(1737):VARIABLE_DECLARATION:msg = new Message(0)
<A NAME="token67">67:</A>70(1724)-70(1737):NEW:new Message(0)
<A NAME="token68">68:</A>71(1753)-71(1778):VARIABLE_DECLARATION:msgJson = gson.toJson(msg)
<A NAME="token69">69:</A>71(1763)-71(1778):METHOD_INVOCATION:gson.toJson(msg)
<A NAME="token70">70:</A>72(1787)-72(1805):METHOD_INVOCATION:ctx.result(msgJson)
<A NAME="token71">71:</A>73(1812)-73(1812):BLOCK_END:}
<A NAME="token72">72:</A>73(1812)-73(1812):IF_END:}
<A NAME="token73">73:</A>76(1868)-76(1894):IF:if (app=="/move/:playerId")
<A NAME="token74">74:</A>76(1896)-76(1896):BLOCK:{
<A NAME="token75">75:</A>77(1911)-77(1946):VARIABLE_DECLARATION:playerID = ctx.pathParam("playerId")
<A NAME="token76">76:</A>77(1922)-77(1946):METHOD_INVOCATION:ctx.pathParam("playerId")
<A NAME="token77">77:</A>78(1962)-78(2023):VARIABLE_DECLARATION:player = gameBoard.getPlayerObject(Integer.parseInt(playerID))
<A NAME="token78">78:</A>78(1971)-78(2023):METHOD_INVOCATION:gameBoard.getPlayerObject(Integer.parseInt(playerID))
<A NAME="token79">79:</A>78(1997)-78(2022):METHOD_INVOCATION:Integer.parseInt(playerID)
<A NAME="token80">80:</A>80(2082)-80(2136):IF:if (player.getPlayerId() != gameBoard.getCurrentTurn())
<A NAME="token81">81:</A>80(2086)-80(2105):METHOD_INVOCATION:player.getPlayerId()
<A NAME="token82">82:</A>80(2110)-80(2135):METHOD_INVOCATION:gameBoard.getCurrentTurn()
<A NAME="token83">83:</A>80(2138)-80(2138):BLOCK:{
<A NAME="token84">84:</A>81(2156)-81(2175):VARIABLE_DECLARATION:msg = new Message(2)
<A NAME="token85">85:</A>81(2162)-81(2175):NEW:new Message(2)
<A NAME="token86">86:</A>82(2193)-82(2218):VARIABLE_DECLARATION:msgJson = gson.toJson(msg)
<A NAME="token87">87:</A>82(2203)-82(2218):METHOD_INVOCATION:gson.toJson(msg)
<A NAME="token88">88:</A>83(2229)-83(2247):METHOD_INVOCATION:ctx.result(msgJson)
<A NAME="token89">89:</A>84(2256)-84(2256):BLOCK_END:}
<A NAME="token90">90:</A>84(2256)-84(2256):IF_END:}
<A NAME="token91">91:</A>84(2258)-84(2261):ELSE:else
<A NAME="token92">92:</A>84(2263)-84(2263):BLOCK:{
<A NAME="token93">93:</A>85(2280)-85(2296):VARIABLE_DECLARATION:move = ctx.body()
<A NAME="token94">94:</A>85(2287)-85(2296):METHOD_INVOCATION:ctx.body()
<A NAME="token95">95:</A>86(2307)-86(2311):TRY:try {
<A NAME="token96">96:</A>88(2381)-88(2415):VARIABLE_DECLARATION:playerMove = new Move(player, move)
<A NAME="token97">97:</A>88(2394)-88(2415):NEW:new Move(player, move)
<A NAME="token98">98:</A>89(2428)-89(2457):METHOD_INVOCATION:gameBoard.makeMove(playerMove)
<A NAME="token99">99:</A>90(2477)-90(2514):VARIABLE_DECLARATION:gameBoardJson = gson.toJson(gameBoard)
<A NAME="token100">100:</A>90(2493)-90(2514):METHOD_INVOCATION:gson.toJson(gameBoard)
<A NAME="token101">101:</A>91(2527)-91(2566):METHOD_INVOCATION:sendGameBoardToAllPlayers(gameBoardJson)
<A NAME="token102">102:</A>92(2577)-92(2577):TRY_END:}
<A NAME="token103">103:</A>92(2579)-92(2599):CATCH:catch (Exception e) {
<A NAME="token104">104:</A>93(2619)-93(2638):VARIABLE_DECLARATION:msg = new Message(1)
<A NAME="token105">105:</A>93(2625)-93(2638):NEW:new Message(1)
<A NAME="token106">106:</A>94(2658)-94(2683):VARIABLE_DECLARATION:msgJson = gson.toJson(msg)
<A NAME="token107">107:</A>94(2668)-94(2683):METHOD_INVOCATION:gson.toJson(msg)
<A NAME="token108">108:</A>95(2696)-95(2714):METHOD_INVOCATION:ctx.result(msgJson)
<A NAME="token109">109:</A>97(2778)-97(2778):CATCH_END:}
<A NAME="token110">110:</A>98(2786)-98(2786):BLOCK_END:}
<A NAME="token111">111:</A>98(2786)-98(2786):ELSE_END:}
<A NAME="token112">112:</A>99(2792)-99(2792):BLOCK_END:}
<A NAME="token113">113:</A>99(2792)-99(2792):IF_END:}
<A NAME="token114">114:</A>102(2844)-102(2882):METHOD_INVOCATION:app.ws("/gameboard", new UiWebSocket())
<A NAME="token115">115:</A>102(2865)-102(2881):NEW:new UiWebSocket()
<A NAME="token116">116:</A>103(2887)-103(2887):METHOD_DECLARATION_END:}
<A NAME="token117">117:</A>111(3066)-111(3120):METHOD_DECLARATION:sendGameBoardToAllPlayers(final String gameBoardJson) {
<A NAME="token118">118:</A>112(3141)-112(3176):VARIABLE_DECLARATION:sessions = UiWebSocket.getSessions()
<A NAME="token119">119:</A>112(3152)-112(3176):METHOD_INVOCATION:UiWebSocket.getSessions()
<A NAME="token120">120:</A>113(3183)-113(3220):FOR:for (Session sessionPlayer : sessions)
<A NAME="token121">121:</A>113(3222)-113(3222):BLOCK:{
<A NAME="token122">122:</A>114(3230)-114(3234):TRY:try {
<A NAME="token123">123:</A>115(3244)-115(3268):METHOD_INVOCATION:sessionPlayer.getRemote()
<A NAME="token124">124:</A>115(3244)-115(3294):METHOD_INVOCATION:sessionPlayer.getRemote().sendString(gameBoardJson)
<A NAME="token125">125:</A>116(3303)-116(3303):TRY_END:}
<A NAME="token126">126:</A>116(3305)-116(3327):CATCH:catch (IOException e) {
<A NAME="token127">127:</A>118(3380)-118(3380):CATCH_END:}
<A NAME="token128">128:</A>119(3386)-119(3386):BLOCK_END:}
<A NAME="token129">129:</A>119(3386)-119(3386):FOR_END:}
<A NAME="token130">130:</A>120(3390)-120(3390):METHOD_DECLARATION_END:}
<A NAME="token131">131:</A>122(3414)-122(3421):METHOD_DECLARATION:stop() {
<A NAME="token132">132:</A>123(3427)-123(3436):METHOD_INVOCATION:app.stop()
<A NAME="token133">133:</A>124(3441)-124(3441):METHOD_DECLARATION_END:}
<A NAME="token134">134:</A>125(3443)-125(3443):CLASS_DECLARATION_END:}
</PRE></CODE>
</BODY>
</HTML>
