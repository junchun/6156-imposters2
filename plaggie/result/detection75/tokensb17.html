<HTML>
<HEAD></HEAD>
<BODY>
<CODE><PRE>
<A NAME="token0">0:</A>1(0)-1(19):PACKAGE_DECLARATION:package controllers;
<A NAME="token1">1:</A>3(22)-3(48):IMPORT_DECLARATION:import java.io.IOException;
<A NAME="token2">2:</A>4(50)-4(75):IMPORT_DECLARATION:import io.javalin.Javalin;
<A NAME="token3">3:</A>5(77)-5(99):IMPORT_DECLARATION:import java.util.Queue;
<A NAME="token4">4:</A>7(102)-7(125):IMPORT_DECLARATION:import models.GameBoard;
<A NAME="token5">5:</A>8(127)-8(148):IMPORT_DECLARATION:import models.Message;
<A NAME="token6">6:</A>9(150)-9(168):IMPORT_DECLARATION:import models.Move;
<A NAME="token7">7:</A>10(170)-10(190):IMPORT_DECLARATION:import models.Player;
<A NAME="token8">8:</A>12(193)-12(239):IMPORT_DECLARATION:import org.eclipse.jetty.websocket.api.Session;
<A NAME="token9">9:</A>12(239)-14(257):CLASS_DECLARATION:;
<A NAME="token10">10:</A>19(337)-19(354):VARIABLE_DECLARATION:PORT_NUMBER = 8080
<A NAME="token11">11:</A>24(452)-24(465):VARIABLE_DECLARATION:X_LOCATION = 2
<A NAME="token12">12:</A>29(565)-29(578):VARIABLE_DECLARATION:Y_LOCATION = 6
<A NAME="token13">13:</A>34(676)-34(685):VARIABLE_DECLARATION:CODE = 100
<A NAME="token14">14:</A>39(748)-39(750):VARIABLE_DECLARATION:app
<A NAME="token15">15:</A>44(859)-44(885):METHOD_DECLARATION:main(final String[] args) {
<A NAME="token16">16:</A>53(968)-53(987):IF:if (app=="/newgame")
<A NAME="token17">17:</A>53(989)-53(989):BLOCK:{
<A NAME="token18">18:</A>54(996)-54(1026):METHOD_INVOCATION:ctx.redirect("/tictactoe.html")
<A NAME="token19">19:</A>55(1033)-55(1033):BLOCK_END:}
<A NAME="token20">20:</A>55(1033)-55(1033):IF_END:}
<A NAME="token21">21:</A>60(1101)-60(1119):VARIABLE_DECLARATION:g = new GameBoard()
<A NAME="token22">22:</A>60(1105)-60(1119):NEW:new GameBoard()
<A NAME="token23">23:</A>66(1192)-66(1213):IF:if (app=="/startgame")
<A NAME="token24">24:</A>66(1215)-66(1215):BLOCK:{
<A NAME="token25">25:</A>68(1276)-68(1292):VARIABLE_DECLARATION:type = ctx.body()
<A NAME="token26">26:</A>68(1283)-68(1292):METHOD_INVOCATION:ctx.body()
<A NAME="token27">27:</A>69(1305)-69(1311):VARIABLE_DECLARATION:t = 'O'
<A NAME="token28">28:</A>70(1319)-70(1344):IF:if (type.equals("type=X"))
<A NAME="token29">29:</A>70(1323)-70(1343):METHOD_INVOCATION:type.equals("type=X")
<A NAME="token30">30:</A>70(1346)-70(1346):BLOCK:{
<A NAME="token31">31:</A>71(1354)-71(1360):ASSIGNMENT:t = 'X'
<A NAME="token32">32:</A>72(1368)-72(1368):BLOCK_END:}
<A NAME="token33">33:</A>72(1368)-72(1368):IF_END:}
<A NAME="token34">34:</A>74(1414)-74(1438):METHOD_INVOCATION:g.setP1(new Player(t, 1))
<A NAME="token35">35:</A>74(1422)-74(1437):NEW:new Player(t, 1)
<A NAME="token36">36:</A>77(1484)-77(1505):METHOD_INVOCATION:ctx.result(g.toJson())
<A NAME="token37">37:</A>77(1495)-77(1504):METHOD_INVOCATION:g.toJson()
<A NAME="token38">38:</A>78(1512)-78(1512):BLOCK_END:}
<A NAME="token39">39:</A>78(1512)-78(1512):IF_END:}
<A NAME="token40">40:</A>83(1591)-83(1611):IF:if (app=="/joingame")
<A NAME="token41">41:</A>83(1613)-83(1613):BLOCK:{
<A NAME="token42">42:</A>84(1620)-84(1654):METHOD_INVOCATION:ctx.redirect("/tictactoe.html?p=2")
<A NAME="token43">43:</A>86(1715)-86(1742):VARIABLE_DECLARATION:p1Type = g.getP1().getType()
<A NAME="token44">44:</A>86(1724)-86(1732):METHOD_INVOCATION:g.getP1()
<A NAME="token45">45:</A>86(1724)-86(1742):METHOD_INVOCATION:g.getP1().getType()
<A NAME="token46">46:</A>87(1755)-87(1763):VARIABLE_DECLARATION:tmp = 'O'
<A NAME="token47">47:</A>88(1771)-88(1788):IF:if (p1Type == 'O')
<A NAME="token48">48:</A>88(1790)-88(1790):BLOCK:{
<A NAME="token49">49:</A>89(1798)-89(1806):ASSIGNMENT:tmp = 'X'
<A NAME="token50">50:</A>90(1814)-90(1814):BLOCK_END:}
<A NAME="token51">51:</A>90(1814)-90(1814):IF_END:}
<A NAME="token52">52:</A>91(1821)-91(1847):METHOD_INVOCATION:g.setP2(new Player(tmp, 2))
<A NAME="token53">53:</A>91(1829)-91(1846):NEW:new Player(tmp, 2)
<A NAME="token54">54:</A>92(1855)-92(1876):METHOD_INVOCATION:g.setGameStarted(true)
<A NAME="token55">55:</A>93(1884)-93(1920):METHOD_INVOCATION:sendGameBoardToAllPlayers(g.toJson())
<A NAME="token56">56:</A>93(1910)-93(1919):METHOD_INVOCATION:g.toJson()
<A NAME="token57">57:</A>94(1927)-94(1927):BLOCK_END:}
<A NAME="token58">58:</A>94(1927)-94(1927):IF_END:}
<A NAME="token59">59:</A>99(2004)-99(2030):IF:if (app=="/move/:playerId")
<A NAME="token60">60:</A>99(2032)-99(2032):BLOCK:{
<A NAME="token61">61:</A>100(2046)-100(2079):VARIABLE_DECLARATION:player = ctx.pathParam("playerId")
<A NAME="token62">62:</A>100(2055)-100(2079):METHOD_INVOCATION:ctx.pathParam("playerId")
<A NAME="token63">63:</A>101(2091)-101(2119):VARIABLE_DECLARATION:id = Integer.parseInt(player)
<A NAME="token64">64:</A>101(2096)-101(2119):METHOD_INVOCATION:Integer.parseInt(player)
<A NAME="token65">65:</A>103(2132)-103(2187):VARIABLE_DECLARATION:x = Integer.parseInt(ctx.body().charAt(X_LOCATION) + "")
<A NAME="token66">66:</A>103(2136)-103(2187):METHOD_INVOCATION:Integer.parseInt(ctx.body().charAt(X_LOCATION) + "")
<A NAME="token67">67:</A>103(2153)-103(2162):METHOD_INVOCATION:ctx.body()
<A NAME="token68">68:</A>103(2153)-103(2181):METHOD_INVOCATION:ctx.body().charAt(X_LOCATION)
<A NAME="token69">69:</A>104(2199)-104(2254):VARIABLE_DECLARATION:y = Integer.parseInt(ctx.body().charAt(Y_LOCATION) + "")
<A NAME="token70">70:</A>104(2203)-104(2254):METHOD_INVOCATION:Integer.parseInt(ctx.body().charAt(Y_LOCATION) + "")
<A NAME="token71">71:</A>104(2220)-104(2229):METHOD_INVOCATION:ctx.body()
<A NAME="token72">72:</A>104(2220)-104(2248):METHOD_INVOCATION:ctx.body().charAt(Y_LOCATION)
<A NAME="token73">73:</A>106(2270)-106(2308):VARIABLE_DECLARATION:p = ((id == 1) ? g.getP1() : g.getP2())
<A NAME="token74">74:</A>106(2287)-106(2295):METHOD_INVOCATION:g.getP1()
<A NAME="token75">75:</A>106(2299)-106(2307):METHOD_INVOCATION:g.getP2()
<A NAME="token76">76:</A>107(2321)-107(2341):VARIABLE_DECLARATION:m = new Move(p, x, y)
<A NAME="token77">77:</A>107(2325)-107(2341):NEW:new Move(p, x, y)
<A NAME="token78">78:</A>110(2382)-110(2384):VARIABLE_DECLARATION:msg
<A NAME="token79">79:</A>111(2392)-111(2408):IF:if (g.addMove(m))
<A NAME="token80">80:</A>111(2396)-111(2407):METHOD_INVOCATION:g.addMove(m)
<A NAME="token81">81:</A>111(2410)-111(2410):BLOCK:{
<A NAME="token82">82:</A>113(2446)-113(2478):ASSIGNMENT:msg = new Message(true, CODE, "")
<A NAME="token83">83:</A>113(2452)-113(2478):NEW:new Message(true, CODE, "")
<A NAME="token84">84:</A>114(2486)-114(2486):BLOCK_END:}
<A NAME="token85">85:</A>114(2486)-114(2486):IF_END:}
<A NAME="token86">86:</A>114(2488)-114(2491):ELSE:else
<A NAME="token87">87:</A>114(2493)-114(2493):BLOCK:{
<A NAME="token88">88:</A>116(2523)-116(2568):ASSIGNMENT:msg = new Message(false, CODE, "Move Invalid")
<A NAME="token89">89:</A>116(2529)-116(2568):NEW:new Message(false, CODE, "Move Invalid")
<A NAME="token90">90:</A>117(2576)-117(2576):BLOCK_END:}
<A NAME="token91">91:</A>117(2576)-117(2576):ELSE_END:}
<A NAME="token92">92:</A>119(2604)-119(2628):METHOD_INVOCATION:ctx.result(msg.getJson())
<A NAME="token93">93:</A>119(2615)-119(2627):METHOD_INVOCATION:msg.getJson()
<A NAME="token94">94:</A>121(2665)-121(2701):METHOD_INVOCATION:sendGameBoardToAllPlayers(g.toJson())
<A NAME="token95">95:</A>121(2691)-121(2700):METHOD_INVOCATION:g.toJson()
<A NAME="token96">96:</A>123(2710)-123(2710):BLOCK_END:}
<A NAME="token97">97:</A>123(2710)-123(2710):IF_END:}
<A NAME="token98">98:</A>126(2762)-126(2800):METHOD_INVOCATION:app.ws("/gameboard", new UiWebSocket())
<A NAME="token99">99:</A>126(2783)-126(2799):NEW:new UiWebSocket()
<A NAME="token100">100:</A>127(2805)-127(2805):METHOD_DECLARATION_END:}
<A NAME="token101">101:</A>133(2973)-133(3027):METHOD_DECLARATION:sendGameBoardToAllPlayers(final String gameBoardJson) {
<A NAME="token102">102:</A>134(3048)-134(3083):VARIABLE_DECLARATION:sessions = UiWebSocket.getSessions()
<A NAME="token103">103:</A>134(3059)-134(3083):METHOD_INVOCATION:UiWebSocket.getSessions()
<A NAME="token104">104:</A>135(3090)-135(3127):FOR:for (Session sessionPlayer : sessions)
<A NAME="token105">105:</A>135(3129)-135(3129):BLOCK:{
<A NAME="token106">106:</A>136(3137)-136(3141):TRY:try {
<A NAME="token107">107:</A>137(3151)-137(3175):METHOD_INVOCATION:sessionPlayer.getRemote()
<A NAME="token108">108:</A>137(3151)-137(3201):METHOD_INVOCATION:sessionPlayer.getRemote().sendString(gameBoardJson)
<A NAME="token109">109:</A>138(3210)-138(3210):TRY_END:}
<A NAME="token110">110:</A>138(3212)-138(3234):CATCH:catch (IOException e) {
<A NAME="token111">111:</A>140(3268)-140(3309):METHOD_INVOCATION:System.out.println("something went wrong")
<A NAME="token112">112:</A>141(3318)-141(3318):CATCH_END:}
<A NAME="token113">113:</A>142(3324)-142(3324):BLOCK_END:}
<A NAME="token114">114:</A>142(3324)-142(3324):FOR_END:}
<A NAME="token115">115:</A>143(3328)-143(3328):METHOD_DECLARATION_END:}
<A NAME="token116">116:</A>145(3352)-145(3359):METHOD_DECLARATION:stop() {
<A NAME="token117">117:</A>146(3365)-146(3374):METHOD_INVOCATION:app.stop()
<A NAME="token118">118:</A>147(3379)-147(3379):METHOD_DECLARATION_END:}
<A NAME="token119">119:</A>148(3381)-148(3381):CLASS_DECLARATION_END:}
</PRE></CODE>
</BODY>
</HTML>
