<HTML>
<HEAD></HEAD>
<BODY>
<CODE><PRE>
<A NAME="token0">0:</A>1(0)-1(19):PACKAGE_DECLARATION:package controllers;
<A NAME="token1">1:</A>4(23)-4(50):IMPORT_DECLARATION:import com.google.gson.Gson;
<A NAME="token2">2:</A>5(52)-5(77):IMPORT_DECLARATION:import io.javalin.Javalin;
<A NAME="token3">3:</A>6(79)-6(105):IMPORT_DECLARATION:import java.io.IOException;
<A NAME="token4">4:</A>7(107)-7(129):IMPORT_DECLARATION:import java.util.Queue;
<A NAME="token5">5:</A>8(131)-8(154):IMPORT_DECLARATION:import models.GameBoard;
<A NAME="token6">6:</A>9(156)-9(176):IMPORT_DECLARATION:import models.Player;
<A NAME="token7">7:</A>10(178)-10(224):IMPORT_DECLARATION:import org.eclipse.jetty.websocket.api.Session;
<A NAME="token8">8:</A>10(224)-12(242):CLASS_DECLARATION:;
<A NAME="token9">9:</A>14(272)-14(289):VARIABLE_DECLARATION:PORT_NUMBER = 8080
<A NAME="token10">10:</A>16(318)-16(320):VARIABLE_DECLARATION:app
<A NAME="token11">11:</A>21(429)-21(455):METHOD_DECLARATION:main(final String[] args) {
<A NAME="token12">12:</A>25(487)-25(503):IF:if (app=="/echo")
<A NAME="token13">13:</A>25(505)-25(505):BLOCK:{
<A NAME="token14">14:</A>26(513)-26(534):METHOD_INVOCATION:ctx.result(ctx.body())
<A NAME="token15">15:</A>26(524)-26(533):METHOD_INVOCATION:ctx.body()
<A NAME="token16">16:</A>27(541)-27(541):BLOCK_END:}
<A NAME="token17">17:</A>27(541)-27(541):IF_END:}
<A NAME="token18">18:</A>30(572)-30(584):IF:if (app=="/")
<A NAME="token19">19:</A>30(586)-30(586):BLOCK:{
<A NAME="token20">20:</A>31(594)-31(645):METHOD_INVOCATION:ctx.result("Please go to /newgame to start a game.")
<A NAME="token21">21:</A>32(652)-32(652):BLOCK_END:}
<A NAME="token22">22:</A>32(652)-32(652):IF_END:}
<A NAME="token23">23:</A>34(669)-34(690):VARIABLE_DECLARATION:game = new GameBoard()
<A NAME="token24">24:</A>34(676)-34(690):NEW:new GameBoard()
<A NAME="token25">25:</A>35(702)-35(718):VARIABLE_DECLARATION:gson = new Gson()
<A NAME="token26">26:</A>35(709)-35(718):NEW:new Gson()
<A NAME="token27">27:</A>38(746)-38(765):IF:if (app=="/newgame")
<A NAME="token28">28:</A>38(767)-38(767):BLOCK:{
<A NAME="token29">29:</A>39(775)-39(804):METHOD_INVOCATION:ctx.redirect("tictactoe.html")
<A NAME="token30">30:</A>40(813)-40(852):METHOD_INVOCATION:ctx.result("Redirect to tictactoe.html")
<A NAME="token31">31:</A>41(859)-41(859):BLOCK_END:}
<A NAME="token32">32:</A>41(859)-41(859):IF_END:}
<A NAME="token33">33:</A>44(927)-44(948):IF:if (app=="/startgame")
<A NAME="token34">34:</A>44(950)-44(950):BLOCK:{
<A NAME="token35">35:</A>46(995)-46(1046):VARIABLE_DECLARATION:type = ctx.req.getParameter("type").toCharArray()[0]
<A NAME="token36">36:</A>46(1002)-46(1029):METHOD_INVOCATION:ctx.req.getParameter("type")
<A NAME="token37">37:</A>46(1002)-46(1043):METHOD_INVOCATION:ctx.req.getParameter("type").toCharArray()
<A NAME="token38">38:</A>47(1055)-47(1085):METHOD_INVOCATION:game.setP1(new Player(type, 1))
<A NAME="token39">39:</A>47(1066)-47(1084):NEW:new Player(type, 1)
<A NAME="token40">40:</A>48(1094)-48(1120):METHOD_INVOCATION:ctx.json(gson.toJson(game))
<A NAME="token41">41:</A>48(1103)-48(1119):METHOD_INVOCATION:gson.toJson(game)
<A NAME="token42">42:</A>49(1127)-49(1127):BLOCK_END:}
<A NAME="token43">43:</A>49(1127)-49(1127):IF_END:}
<A NAME="token44">44:</A>52(1171)-52(1191):IF:if (app=="/joingame")
<A NAME="token45">45:</A>52(1193)-52(1193):BLOCK:{
<A NAME="token46">46:</A>53(1201)-53(1212):METHOD_INVOCATION:game.setP2()
<A NAME="token47">47:</A>54(1221)-54(1255):METHOD_INVOCATION:ctx.redirect("/tictactoe.html?p=2")
<A NAME="token48">48:</A>55(1264)-55(1307):METHOD_INVOCATION:sendGameBoardToAllPlayers(gson.toJson(game))
<A NAME="token49">49:</A>55(1290)-55(1306):METHOD_INVOCATION:gson.toJson(game)
<A NAME="token50">50:</A>56(1314)-56(1314):BLOCK_END:}
<A NAME="token51">51:</A>56(1314)-56(1314):IF_END:}
<A NAME="token52">52:</A>59(1365)-59(1391):IF:if (app=="/move/:playerId")
<A NAME="token53">53:</A>59(1393)-59(1393):BLOCK:{
<A NAME="token54">54:</A>60(1405)-60(1452):VARIABLE_DECLARATION:id = Integer.parseInt(ctx.pathParam("playerId"))
<A NAME="token55">55:</A>60(1410)-60(1452):METHOD_INVOCATION:Integer.parseInt(ctx.pathParam("playerId"))
<A NAME="token56">56:</A>60(1427)-60(1451):METHOD_INVOCATION:ctx.pathParam("playerId")
<A NAME="token57">57:</A>61(1465)-61(1511):VARIABLE_DECLARATION:x = Integer.parseInt(ctx.req.getParameter("x"))
<A NAME="token58">58:</A>61(1469)-61(1511):METHOD_INVOCATION:Integer.parseInt(ctx.req.getParameter("x"))
<A NAME="token59">59:</A>61(1486)-61(1510):METHOD_INVOCATION:ctx.req.getParameter("x")
<A NAME="token60">60:</A>62(1524)-62(1570):VARIABLE_DECLARATION:y = Integer.parseInt(ctx.req.getParameter("y"))
<A NAME="token61">61:</A>62(1528)-62(1570):METHOD_INVOCATION:Integer.parseInt(ctx.req.getParameter("y"))
<A NAME="token62">62:</A>62(1545)-62(1569):METHOD_INVOCATION:ctx.req.getParameter("y")
<A NAME="token63">63:</A>63(1579)-63(1624):METHOD_INVOCATION:ctx.json(gson.toJson(game.makeMove(id, x, y)))
<A NAME="token64">64:</A>63(1588)-63(1623):METHOD_INVOCATION:gson.toJson(game.makeMove(id, x, y))
<A NAME="token65">65:</A>63(1600)-63(1622):METHOD_INVOCATION:game.makeMove(id, x, y)
<A NAME="token66">66:</A>64(1633)-64(1676):METHOD_INVOCATION:sendGameBoardToAllPlayers(gson.toJson(game))
<A NAME="token67">67:</A>64(1659)-64(1675):METHOD_INVOCATION:gson.toJson(game)
<A NAME="token68">68:</A>65(1683)-65(1683):BLOCK_END:}
<A NAME="token69">69:</A>65(1683)-65(1683):IF_END:}
<A NAME="token70">70:</A>70(1745)-70(1783):METHOD_INVOCATION:app.ws("/gameboard", new UiWebSocket())
<A NAME="token71">71:</A>70(1766)-70(1782):NEW:new UiWebSocket()
<A NAME="token72">72:</A>71(1788)-71(1788):METHOD_DECLARATION_END:}
<A NAME="token73">73:</A>77(1956)-77(2010):METHOD_DECLARATION:sendGameBoardToAllPlayers(final String gameBoardJson) {
<A NAME="token74">74:</A>78(2031)-78(2066):VARIABLE_DECLARATION:sessions = UiWebSocket.getSessions()
<A NAME="token75">75:</A>78(2042)-78(2066):METHOD_INVOCATION:UiWebSocket.getSessions()
<A NAME="token76">76:</A>79(2073)-79(2110):FOR:for (Session sessionPlayer : sessions)
<A NAME="token77">77:</A>79(2112)-79(2112):BLOCK:{
<A NAME="token78">78:</A>80(2120)-80(2124):TRY:try {
<A NAME="token79">79:</A>81(2134)-81(2158):METHOD_INVOCATION:sessionPlayer.getRemote()
<A NAME="token80">80:</A>81(2134)-81(2184):METHOD_INVOCATION:sessionPlayer.getRemote().sendString(gameBoardJson)
<A NAME="token81">81:</A>82(2193)-82(2193):TRY_END:}
<A NAME="token82">82:</A>82(2195)-82(2217):CATCH:catch (IOException e) {
<A NAME="token83">83:</A>84(2252)-84(2252):CATCH_END:}
<A NAME="token84">84:</A>85(2258)-85(2258):BLOCK_END:}
<A NAME="token85">85:</A>85(2258)-85(2258):FOR_END:}
<A NAME="token86">86:</A>86(2262)-86(2262):METHOD_DECLARATION_END:}
<A NAME="token87">87:</A>88(2286)-88(2293):METHOD_DECLARATION:stop() {
<A NAME="token88">88:</A>89(2299)-89(2308):METHOD_INVOCATION:app.stop()
<A NAME="token89">89:</A>90(2313)-90(2313):METHOD_DECLARATION_END:}
<A NAME="token90">90:</A>91(2315)-91(2315):CLASS_DECLARATION_END:}
</PRE></CODE>
</BODY>
</HTML>
