<HTML>
<HEAD></HEAD>
<BODY>
<CODE><PRE>
<A NAME="token0">0:</A>1(0)-1(19):PACKAGE_DECLARATION:package controllers;
<A NAME="token1">1:</A>3(22)-3(49):IMPORT_DECLARATION:import com.google.gson.Gson;
<A NAME="token2">2:</A>4(51)-4(76):IMPORT_DECLARATION:import io.javalin.Javalin;
<A NAME="token3">3:</A>5(78)-5(104):IMPORT_DECLARATION:import java.io.IOException;
<A NAME="token4">4:</A>6(106)-6(128):IMPORT_DECLARATION:import java.util.Queue;
<A NAME="token5">5:</A>7(130)-7(153):IMPORT_DECLARATION:import models.GameBoard;
<A NAME="token6">6:</A>8(155)-8(176):IMPORT_DECLARATION:import models.Message;
<A NAME="token7">7:</A>9(178)-9(196):IMPORT_DECLARATION:import models.Move;
<A NAME="token8">8:</A>10(198)-10(218):IMPORT_DECLARATION:import models.Player;
<A NAME="token9">9:</A>11(220)-11(266):IMPORT_DECLARATION:import org.eclipse.jetty.websocket.api.Session;
<A NAME="token10">10:</A>12(268)-12(291):IMPORT_DECLARATION:import org.slf4j.Logger;
<A NAME="token11">11:</A>13(293)-13(323):IMPORT_DECLARATION:import org.slf4j.LoggerFactory;
<A NAME="token12">12:</A>13(323)-16(342):CLASS_DECLARATION:;
<A NAME="token13">13:</A>18(372)-18(389):VARIABLE_DECLARATION:PORT_NUMBER = 8080
<A NAME="token14">14:</A>20(418)-20(420):VARIABLE_DECLARATION:app
<A NAME="token15">15:</A>23(489)-23(497):VARIABLE_DECLARATION:gameBoard
<A NAME="token16">16:</A>26(575)-26(591):VARIABLE_DECLARATION:gson = new Gson()
<A NAME="token17">17:</A>26(582)-26(591):NEW:new Gson()
<A NAME="token18">18:</A>29(675)-29(722):VARIABLE_DECLARATION:logger = LoggerFactory.getLogger(PlayGame.class)
<A NAME="token19">19:</A>29(684)-29(722):METHOD_INVOCATION:LoggerFactory.getLogger(PlayGame.class)
<A NAME="token20">20:</A>34(831)-34(857):METHOD_DECLARATION:main(final String[] args) {
<A NAME="token21">21:</A>38(889)-38(905):IF:if (app=="/echo")
<A NAME="token22">22:</A>38(907)-38(907):BLOCK:{
<A NAME="token23">23:</A>39(915)-39(936):METHOD_INVOCATION:ctx.result(ctx.body())
<A NAME="token24">24:</A>39(926)-39(935):METHOD_INVOCATION:ctx.body()
<A NAME="token25">25:</A>40(943)-40(943):BLOCK_END:}
<A NAME="token26">26:</A>40(943)-40(943):IF_END:}
<A NAME="token27">27:</A>43(970)-43(989):IF:if (app=="/newgame")
<A NAME="token28">28:</A>43(991)-43(991):BLOCK:{
<A NAME="token29">29:</A>44(999)-44(1025):ASSIGNMENT:gameBoard = new GameBoard()
<A NAME="token30">30:</A>44(1011)-44(1025):NEW:new GameBoard()
<A NAME="token31">31:</A>45(1034)-45(1063):METHOD_INVOCATION:ctx.redirect("tictactoe.html")
<A NAME="token32">32:</A>46(1070)-46(1070):BLOCK_END:}
<A NAME="token33">33:</A>46(1070)-46(1070):IF_END:}
<A NAME="token34">34:</A>49(1098)-49(1119):IF:if (app=="/startgame")
<A NAME="token35">35:</A>49(1121)-49(1121):BLOCK:{
<A NAME="token36">36:</A>50(1134)-50(1162):VARIABLE_DECLARATION:type = (ctx.body().charAt(5))
<A NAME="token37">37:</A>50(1142)-50(1151):METHOD_INVOCATION:ctx.body()
<A NAME="token38">38:</A>50(1142)-50(1161):METHOD_INVOCATION:ctx.body().charAt(5)
<A NAME="token39">39:</A>51(1171)-51(1211):METHOD_INVOCATION:gameBoard.setPlayer1(new Player(type, 1))
<A NAME="token40">40:</A>51(1192)-51(1210):NEW:new Player(type, 1)
<A NAME="token41">41:</A>52(1220)-52(1253):METHOD_INVOCATION:ctx.result(gson.toJson(gameBoard))
<A NAME="token42">42:</A>52(1231)-52(1252):METHOD_INVOCATION:gson.toJson(gameBoard)
<A NAME="token43">43:</A>53(1260)-53(1260):BLOCK_END:}
<A NAME="token44">44:</A>53(1260)-53(1260):IF_END:}
<A NAME="token45">45:</A>56(1307)-56(1327):IF:if (app=="/joingame")
<A NAME="token46">46:</A>56(1329)-56(1329):BLOCK:{
<A NAME="token47">47:</A>57(1337)-57(1356):METHOD_INVOCATION:gameBoard.joinGame()
<A NAME="token48">48:</A>58(1365)-58(1399):METHOD_INVOCATION:ctx.redirect("/tictactoe.html?p=2")
<A NAME="token49">49:</A>59(1408)-59(1456):METHOD_INVOCATION:sendGameBoardToAllPlayers(gson.toJson(gameBoard))
<A NAME="token50">50:</A>59(1434)-59(1455):METHOD_INVOCATION:gson.toJson(gameBoard)
<A NAME="token51">51:</A>60(1463)-60(1463):BLOCK_END:}
<A NAME="token52">52:</A>60(1463)-60(1463):IF_END:}
<A NAME="token53">53:</A>63(1500)-63(1526):IF:if (app=="/move/:playerId")
<A NAME="token54">54:</A>63(1528)-63(1528):BLOCK:{
<A NAME="token55">55:</A>64(1540)-64(1590):VARIABLE_DECLARATION:i = Character.getNumericValue(ctx.body().charAt(2))
<A NAME="token56">56:</A>64(1544)-64(1590):METHOD_INVOCATION:Character.getNumericValue(ctx.body().charAt(2))
<A NAME="token57">57:</A>64(1570)-64(1579):METHOD_INVOCATION:ctx.body()
<A NAME="token58">58:</A>64(1570)-64(1589):METHOD_INVOCATION:ctx.body().charAt(2)
<A NAME="token59">59:</A>65(1603)-65(1653):VARIABLE_DECLARATION:j = Character.getNumericValue(ctx.body().charAt(6))
<A NAME="token60">60:</A>65(1607)-65(1653):METHOD_INVOCATION:Character.getNumericValue(ctx.body().charAt(6))
<A NAME="token61">61:</A>65(1633)-65(1642):METHOD_INVOCATION:ctx.body()
<A NAME="token62">62:</A>65(1633)-65(1652):METHOD_INVOCATION:ctx.body().charAt(6)
<A NAME="token63">63:</A>66(1666)-66(1718):VARIABLE_DECLARATION:playerId = Integer.valueOf(ctx.pathParam("playerId"))
<A NAME="token64">64:</A>66(1677)-66(1718):METHOD_INVOCATION:Integer.valueOf(ctx.pathParam("playerId"))
<A NAME="token65">65:</A>66(1693)-66(1717):METHOD_INVOCATION:ctx.pathParam("playerId")
<A NAME="token66">66:</A>67(1735)-67(1774):VARIABLE_DECLARATION:message = gameBoard.move(i, j, playerId)
<A NAME="token67">67:</A>67(1745)-67(1774):METHOD_INVOCATION:gameBoard.move(i, j, playerId)
<A NAME="token68">68:</A>68(1783)-68(1814):METHOD_INVOCATION:ctx.result(gson.toJson(message))
<A NAME="token69">69:</A>68(1794)-68(1813):METHOD_INVOCATION:gson.toJson(message)
<A NAME="token70">70:</A>69(1823)-69(1871):METHOD_INVOCATION:sendGameBoardToAllPlayers(gson.toJson(gameBoard))
<A NAME="token71">71:</A>69(1849)-69(1870):METHOD_INVOCATION:gson.toJson(gameBoard)
<A NAME="token72">72:</A>70(1878)-70(1878):BLOCK_END:}
<A NAME="token73">73:</A>70(1878)-70(1878):IF_END:}
<A NAME="token74">74:</A>73(1930)-73(1968):METHOD_INVOCATION:app.ws("/gameboard", new UiWebSocket())
<A NAME="token75">75:</A>73(1951)-73(1967):NEW:new UiWebSocket()
<A NAME="token76">76:</A>74(1973)-74(1973):METHOD_DECLARATION_END:}
<A NAME="token77">77:</A>80(2141)-80(2195):METHOD_DECLARATION:sendGameBoardToAllPlayers(final String gameBoardJson) {
<A NAME="token78">78:</A>81(2216)-81(2251):VARIABLE_DECLARATION:sessions = UiWebSocket.getSessions()
<A NAME="token79">79:</A>81(2227)-81(2251):METHOD_INVOCATION:UiWebSocket.getSessions()
<A NAME="token80">80:</A>82(2258)-82(2295):FOR:for (Session sessionPlayer : sessions)
<A NAME="token81">81:</A>82(2297)-82(2297):BLOCK:{
<A NAME="token82">82:</A>83(2305)-83(2309):TRY:try {
<A NAME="token83">83:</A>84(2319)-84(2343):METHOD_INVOCATION:sessionPlayer.getRemote()
<A NAME="token84">84:</A>84(2319)-84(2369):METHOD_INVOCATION:sessionPlayer.getRemote().sendString(gameBoardJson)
<A NAME="token85">85:</A>85(2378)-85(2378):TRY_END:}
<A NAME="token86">86:</A>85(2380)-85(2402):CATCH:catch (IOException e) {
<A NAME="token87">87:</A>87(2439)-87(2466):METHOD_INVOCATION:logger.error(e.getMessage())
<A NAME="token88">88:</A>87(2452)-87(2465):METHOD_INVOCATION:e.getMessage()
<A NAME="token89">89:</A>88(2477)-88(2495):METHOD_INVOCATION:e.printStackTrace()
<A NAME="token90">90:</A>89(2504)-89(2504):CATCH_END:}
<A NAME="token91">91:</A>90(2510)-90(2510):BLOCK_END:}
<A NAME="token92">92:</A>90(2510)-90(2510):FOR_END:}
<A NAME="token93">93:</A>91(2514)-91(2514):METHOD_DECLARATION_END:}
<A NAME="token94">94:</A>93(2538)-93(2545):METHOD_DECLARATION:stop() {
<A NAME="token95">95:</A>94(2551)-94(2560):METHOD_INVOCATION:app.stop()
<A NAME="token96">96:</A>95(2565)-95(2565):METHOD_DECLARATION_END:}
<A NAME="token97">97:</A>97(2568)-97(2568):CLASS_DECLARATION_END:}
</PRE></CODE>
</BODY>
</HTML>
